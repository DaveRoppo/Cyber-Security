# About
A Malware traffic analysis exercise from a pcap posted on Malware-Traffic-Analysis.net in July 2023 by Brad Duncan featuring IcedID malware.

Link to Brad Duncan's exercise archives: https://www.malware-traffic-analysis.net/

## Tools Used
Security Onion Console
Network Miner
Wireshark
Mitre ATT&CK
Virus Total
URLHaus
MalwareBazaar
Suricata
SHA256

## MITRE ATT&CK IcedID & TA551 Threat Group References
![](img/group.png)

## Incident Report

### Executive summary

On 2023-07-10 at 22:39 UTC, a Windows computer used by rwalters was infected with Redline-Stealer, a Windows-based malware categorized as an information stealer. It is designed to infiltrate systems covertly and exfiltrate sensitive information, including login credentials, cryptocurrency wallets, personal data, and other valuable information to remote command and control (C2) servers operated by threat actors. 

Following the infection of the victim host, an data exfiltration attempt was made to a remote C2 server including the folloiwng:

- Running Processes
- Hardware Specifications
- Files on the victim's desktop
- Files in the victim's Documents folder
- Login credentials from various web browsers
- User data for various  web browsers
- Data for several cryptocurrency wallets and the associated browser plugins 
- API keys

Due to the attempted data exfiltration, rwalters was instructed to change login credentials for all platforms, applications, and services included in the exfiltration attempt.
  
### Victim details

Victim’s IP address: 10.7.10[.]47
Victim’s MAC address: 80:86:5b:ab:1e:c4
Victim’s Windows host name: DESKTOP-9PEA63H
Victim’s Windows user account name: rwalters

### Indicators of compromise (IoCs)
#### IP Addresses, Ports, Domain names, URLs
hxxp://623start[.]site/?status=start&av=
hxxp://623start[.]site/?status=install
hxxp://guiatelefonos[.]com/data/czx.jpg
hxxps://guiatelefonos[.]com/data/czx.jpg
tcp://194.26.135[.]119:12432/

#### Files
SHA256 hash: f754d7674a3a74969cccb7d834c99b72b9f79c29dc8d0e9c15854a6bfb1a9c97
File size: 800 bytes
File name: SECT_v4.ps1
File description: PowerShell script used to kick off the RedLine Stealer infection
Sample available at MalwareBazaar Database

SHA256 hash: 3c42b93801f02696487de64bb623f81cf7baf73a379a46e1459ca19ae7dc2454
File size: 348,160 bytes
File location: hxxps://guiatelefonos[.]com/data/czx.jpg
File description: Windows executable file for RedLine Stealer
Sample available at MalwareBazaar Database

## Local Area Network (LAN) Details 
- LAN segment range: 10.7.10[.]0/24 (10.7.10[.]1 through 10.7.10[.]255)
- Domain: coolweathercoat[.]com
- Domain controller IP address: 10.7.10[.]9
- Domain controller hostname: WIN-S3WT6LGQFVX
- LAN segment gateway: 10.7.10[.]1
- LAN segment broadcast address: 10.7.10[.]255


## Exercise Questions

#### What is the date and time in UTC the infection started? 07-10-23 22:39 UTC
#### What is the IP address of the infected Windows client? 10.7.10[.]47
#### What is the MAC address of the infected Windows client? 80:86:5b:ab:1e:c4
#### What is the hostname of the infected Windows client? DESKTOP-9PEA63H
#### What is the user account name from the infected Windows host? rwalters
#### What type of information did this RedLine Stealer try to steal? *See Below*

![](img/al-any.png)

![](img/al-net.png)

![](img/al-out.png)

![](img/al-ps.png)

![](img/al-resp.png)

![](img/alerts.png)

![](img/dash-beacon.png)

![](img/dash-cert.png)

![](img/dash-conn.png)

![](img/dash-get.png)

![](img/dash-http.png)

![](img/dash-overview.png)

![](img/dash-smb.png)

![](img/exfil-stream.png)

![](img/exfil-stream2.png)

![](img/exfil-stream3.png)

![](img/exfil.png)

![](img/get-623.png)

![](img/get-6232.png)

![](img/group.png)

![](img/haus-gui.png)

![](img/hex.png)

![](img/jpg.png)

![](img/mal.png)

![](img/nm-files.png)

![](img/nm-host.png)

![](img/psasci.png)

![](img/psascis.png)

![](img/pshex.png)

![](img/rpc.png)

![](img/vt-195.png)

![](img/vt-623.png)

![](img/vt194.png)

![](img/vt195.png)

![](img/vt92.png)

![](img/vtchang.png)

![](img/vtgui.png)

![](img/ws-beacon.png)

## Acknowledgements
For a deeper dive into TA551's use of IcedID, see [TA551: Email Attack Campaign Switches from Valak to IcedID](https://unit42.paloaltonetworks.com/ta551-shathak-icedid/)
